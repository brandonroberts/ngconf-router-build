{"version":3,"file":"animation_style_util.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"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","sourcesContent":["import {isPresent, isArray} from '../facade/lang';\nimport {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {AUTO_STYLE} from './metadata';\nimport {FILL_STYLE_FLAG} from './animation_constants';\n\nexport function balanceAnimationStyles(previousStyles: {[key: string]: string|number},\n                     newStyles: {[key: string]: string|number},\n                     nullValue = null): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n\n  StringMapWrapper.forEach(newStyles, (value, prop) => {\n    finalStyles[prop] = value.toString();\n  });\n\n  StringMapWrapper.forEach(previousStyles, (value, prop) => {\n    if (!isPresent(finalStyles[prop])) {\n      finalStyles[prop] = nullValue;\n    }\n  });\n\n  return finalStyles;\n}\n\nexport function balanceAnimationKeyframes(collectedStyles: {[key: string]: string|number},\n                        finalStateStyles: {[key: string]: string|number},\n                        keyframes: any[]): any[] {\n  var limit = keyframes.length - 1;\n  var firstKeyframe = keyframes[0];\n\n  // phase 1: copy all the styles from the first keyframe into the lookup map\n  var flatenedFirstKeyframeStyles = flattenStyles(firstKeyframe.styles.styles);\n\n  var extraFirstKeyframeStyles = {};\n  var hasExtraFirstStyles = false;\n  StringMapWrapper.forEach(collectedStyles, (value, prop) => {\n    // if the style is already defined in the first keyframe then\n    // we do not replace it.\n    if (!flatenedFirstKeyframeStyles[prop]) {\n      flatenedFirstKeyframeStyles[prop] = value;\n      extraFirstKeyframeStyles[prop] = value;\n      hasExtraFirstStyles = true;\n    }\n  });\n\n  var keyframeCollectedStyles = StringMapWrapper.merge({}, flatenedFirstKeyframeStyles);\n\n  // phase 2: normalize the final keyframe\n  var finalKeyframe = keyframes[limit];\n  ListWrapper.insert(finalKeyframe.styles.styles, 0, finalStateStyles);\n\n  var flatenedFinalKeyframeStyles = flattenStyles(finalKeyframe.styles.styles);\n  var extraFinalKeyframeStyles = {};\n  var hasExtraFinalStyles = false;\n  StringMapWrapper.forEach(keyframeCollectedStyles, (value, prop) => {\n    if (!isPresent(flatenedFinalKeyframeStyles[prop])) {\n      extraFinalKeyframeStyles[prop] = AUTO_STYLE;\n      hasExtraFinalStyles = true;\n    }\n  });\n\n  if (hasExtraFinalStyles) {\n    finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n  }\n\n  StringMapWrapper.forEach(flatenedFinalKeyframeStyles, (value, prop) => {\n    if (!isPresent(flatenedFirstKeyframeStyles[prop])) {\n      extraFirstKeyframeStyles[prop] = AUTO_STYLE;\n      hasExtraFirstStyles = true;\n    }\n  });\n\n  if (hasExtraFirstStyles) {\n    firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n  }\n\n  return keyframes;\n}\n\nexport function clearStyles(styles: {[key: string]: string|number}): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n  StringMapWrapper.keys(styles).forEach(key => {\n    finalStyles[key] = null;\n  });\n  return finalStyles;\n}\n\nexport function collectAndResolveStyles(collection: {[key: string]: string|number}, styles: {[key: string]: string|number}[]) {\n  return styles.map(entry => {\n    var stylesObj = {};\n    StringMapWrapper.forEach(entry, (value, prop) => {\n      if (value == FILL_STYLE_FLAG) {\n        value = collection[prop];\n        if (!isPresent(value)) {\n          value = AUTO_STYLE;\n        }\n      }\n      collection[prop] = value;\n      stylesObj[prop] = value;\n    });\n    return stylesObj;\n  });\n}\n\nexport function renderStyles(element: any, renderer: any, styles: {[key: string]: string|number}): void {\n  StringMapWrapper.forEach(styles, (value, prop) => {\n    renderer.setElementStyle(element, prop, value);\n  });\n}\n\nexport function flattenStyles(styles: {[key: string]: string|number}[]) {\n  var finalStyles = {};\n  styles.forEach(entry => {\n    StringMapWrapper.forEach(entry, (value, prop) => {\n      finalStyles[prop] = value;\n    });\n  });\n  return finalStyles;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}